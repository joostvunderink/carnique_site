{% extends "base.html" %}

{% block title %}Quote {{quote.id}}{% endblock %}

{% block contents %}

<p>
    <a href="/quotes/random/">
        <button type="button" class="btn btn-sm btn-default">Toon willekeurige quote</button>
    </a>
</p>
<h3>{{ quote.title }}</h3>
Score <span id="quote_score_{{quote.id}}">{{ quote.score }}</span> -
<span id="quote_vote_text_{{quote.id}}">
{% if quote.can_vote %}
<button class="quote_vote_up" value="{{ quote.id }}">leuk</button> -
<button class="quote_vote_down" value="{{ quote.id }}">stom</button> -
{% else %}
Je kunt nu niet stemmen op deze quote.
{% endif %}
</span>
</p>
<pre>{{ quote.text }}</pre>
<p>Quote <a href="/quotes/{{ quote.id }}/">{{ quote.id }}</a> - 
Toegevoegd door 
{% if q.added_by.is_active and q.added_by.get_profile.is_member %}
<a href="/profile/{{ quote.added_by.username }}">{{ quote.added_by.username }}</a>
{% else %}
{{ quote.added_by.username }}
{% endif %}
op {{ quote.added_on }}

{% endblock %}

{% block footer %}
<script language="javascript">
$(document).ready(function() {
    $("button.quote_vote_up").click(function(e) {
        quote_id = e.target.value;
        console.log("Voting up; quote id = " + quote_id);
        $.post("/quotes/vote/", {
            "quote_id": quote_id,
            "direction": 'up',
        })
        .done(function(data) {
            if (data.success) {
                console.log("Gestemd!");
                quote_id = data.quote_id;
                $("span#quote_score_"+quote_id).html(data.new_score);
                $("span#quote_vote_text_" + quote_id).html("Dank je voor je stem!");;
            }
            else {
                alert("Stemmen mislukt; graag contact opnemen met Garion: " + data.error)
            }
        });
    });
});
</script>
{% endblock %}
